(()=>{"use strict";function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},t(e)}function e(e){var r=function(e,r){if("object"!=t(e)||!e)return e;var o=e[Symbol.toPrimitive];if(void 0!==o){var n=o.call(e,r||"default");if("object"!=t(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(e)}(e,"string");return"symbol"==t(r)?r:r+""}function r(t,r,o){return(r=e(r))in t?Object.defineProperty(t,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[r]=o,t}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,o)}return r}function n(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?o(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}const s=Object.keys({GainIntrigue2:"\u5bc6\u8c0b +2",GainIntrigue:"\u5bc6\u8c0b +1",UselessLocationCover:"\u5730\u70b9\u4f2a\u88c5",DiagonalMove:"\u659c\u5411\u79fb\u52a8",VerticalMove:"\u2191\u2193 \u79fb\u52a8",HorizontalMove:"\u2190\u2192 \u79fb\u52a8",GainParanoia:"\u4e0d\u5b89 +1",LoseParanoia:"\u4e0d\u5b89 -1",ForbidParanoia:"\u7981\u6b62\u4e0d\u5b89",ForbidGoodwill:"\u7981\u6b62\u53cb\u597d"}),a=Object.keys({ForbidMove:"\u7981\u6b62\u79fb\u52a8",GainGoodwill2:"\u53cb\u597d +2",LoseParanoia:"\u4e0d\u5b89 -1",ForbidIntrigue:"\u7981\u6b62\u5bc6\u8c0b",VerticalMove:"\u2191\u2193 \u79fb\u52a8",HorizontalMove:"\u2190\u2192 \u79fb\u52a8",GainGoodwill:"\u53cb\u597d +1",GainParanoia:"\u4e0d\u5b89 +1"}),i=Object.keys({Hospital:"\u533b\u9662",Shrine:"\u795e\u793e",City:"\u90fd\u5e02",School:"\u5b66\u6821"});Object.keys({BoyStudent:"\u7537\u5b66\u751f",GirlStudent:"\u5973\u5b66\u751f",RichMansDaughter:"\u5927\u5c0f\u59d0",ClassRep:"\u73ed\u957f",MysteryBoy:"\u5c40\u5916\u4eba",ShrineMaiden:"\u5deb\u5973",Alien:"\u5f02\u754c\u4eba",GodlyBeing:"\u795e\u7075",PoliceOfficer:"\u5211\u8b66",OfficeWorker:"\u804c\u5458",Informer:"\u60c5\u62a5\u5546",PopIdol:"\u5076\u50cf",Journalist:"\u5a92\u4f53\u4eba",Boss:"\u5927\u4eba\u7269",Doctor:"\u533b\u751f",Patient:"\u4f4f\u9662\u60a3\u8005",Nurse:"\u62a4\u58eb",Henchman:"\u624b\u4e0b",IdentificationOfficer:"\u9274\u522b\u5458",ArmyMan:"\u519b\u4eba"});let c,l=!1;function u(){const t={};return s.forEach((e=>{t[e]={count:0,sum:0,bestValue:-1/0,bestProtagPlacement:{},worstValue:1/0,worstProtagPlacement:{}}})),t}function f(){const t={};return a.forEach((e=>{t[e]={count:0,sum:0,bestValue:-1/0,bestMasterPlacement:{},worstValue:1/0,worstMasterPlacement:{}}})),t}function b(t,e){if(0===e)return[[]];if(t.length<e)return[];const[r,...o]=t;return[...b(o,e-1).map((t=>[r,...t])),...b(o,e)]}class p{async compute(t){return 0}}async function y(t,e,r,o,s){if(l)return;const u=Object.keys(t).filter((e=>t[e]>0)),f=new Set,p={},y=async m=>{if(l)return;if(m===u.length){const t=new Set;u.forEach((e=>{(p[e]||[]).forEach((e=>{i.includes(e)&&t.add(e)}))}));const r=n({},o);if(o.ForbidIntrigue){const e=o.ForbidIntrigue.filter((e=>!(i.includes(e)&&!t.has(e))));r.ForbidIntrigue=e}const f=function(t,e,r){const o=[],s={};return function r(a,i){if(a===t.length)return void(0===i&&o.push(n({},s)));const c=t[a],l=Math.min(e[c],i);for(let t=0;t<=l;t++)s[c]=t,r(a+1,i-t)}(0,r),o}(a,e,3);for(const e of f){if(l)return;const t=Object.keys(e).filter((t=>e[t]>0)),o=new Set,n={},a=async i=>{if(l)return;if(i===t.length){const e=await s.compute({mastermindPlacement:p,protagonistPlacement:n});if(u.forEach((t=>{const r=c.mastermindStats[t];r.count+=1,r.sum+=e,e>r.bestValue&&(r.bestValue=e,r.bestProtagPlacement=JSON.parse(JSON.stringify(n))),e<r.worstValue&&(r.worstValue=e,r.worstProtagPlacement=JSON.parse(JSON.stringify(n)))})),t.forEach((t=>{const r=c.protagonistStats[t];r.count+=1,r.sum+=e,e>r.bestValue&&(r.bestValue=e,r.bestMasterPlacement=JSON.parse(JSON.stringify(p))),e<r.worstValue&&(r.worstValue=e,r.worstMasterPlacement=JSON.parse(JSON.stringify(p)))})),c.processedCount+=1,c.processedCount%5e3===0){const t={type:"progress",processed:5e3};globalThis.postMessage(t)}return}const f=t[i],y=e[f],m=b((r[f]||[]).filter((t=>!o.has(t))),y);for(const t of m){if(l)return;t.forEach((t=>o.add(t))),n[f]=t,await Promise.resolve(),await a(i+1),t.forEach((t=>o.delete(t)))}};await a(0)}return}const g=u[m],d=t[g],P=b((r[g]||[]).filter((t=>!f.has(t))),d);for(const t of P){if(l)return;t.forEach((t=>f.add(t))),p[g]=t,await Promise.resolve(),await y(m+1),t.forEach((t=>f.delete(t)))}};await y(0)}globalThis.addEventListener("message",(t=>{const e=t.data;"start"===e.type?(l=!1,async function(t,e,r,o){c={mastermindStats:u(),protagonistStats:f(),processedCount:0};const n=new p;for(const i of t){if(l)break;await y(i,e,r,o,n)}const s=c.processedCount%5e3;if(s>0){const t={type:"progress",processed:s};globalThis.postMessage(t)}const a={type:"done",localMastermindStats:c.mastermindStats,localProtagonistStats:c.protagonistStats};globalThis.postMessage(a),globalThis.close()}(e.sliceDistributions,e.protagonistConfig,e.mastermindScope,e.protagonistScope)):"cancel"===e.type&&(l=!0)}))})();
//# sourceMappingURL=21.d74b40e8.chunk.js.map